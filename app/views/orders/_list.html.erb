<div class="table-responsive">
  <table class="table table-striped table-condensed table-orders-list">
    <thead>
      <tr>
        <th><%= t '.customer' %></th>
        <th><%= t '.starters' %></th>
        <th><%= t '.main_courses' %></th>
        <th><%= t '.desserts' %></th>
        <th><%= t '.drinks' %></th>
        <th class="text-right"><%= t '.total_price' %></th>
        <th class="text-center"><%= t '.sent_at' %></th>
        <th class="text-center"><%= t '.ready_at' %></th>
        <th class="text-center"><%= t '.delivered_at' %></th>
      </tr>
    </thead>

    <tbody>
      <% orders.each do |order| %>
        <tr>
          <td>
            <%= order.decorate.user.name %>
          </td>
          <td>
            <% order.ordered_meals.at_timing("starter").each do |ordered_meal| %>
              <p><%= ordered_meal.decorate %></p>
            <% end %>
          </td>
          <td>
            <% order.ordered_meals.at_timing("main_course").each do |ordered_meal| %>
              <p><%= ordered_meal.decorate %></p>
            <% end %>
          </td>
          <td>
            <% order.ordered_meals.at_timing("dessert").each do |ordered_meal| %>
              <p><%= ordered_meal.decorate %></p>
            <% end %>
          </td>
          <td>
            <% order.ordered_meals.at_timing("drink").each do |ordered_meal| %>
              <p><%= ordered_meal.decorate %></p>
            <% end %>
          </td>
          <td class="text-right">
            <% case order.state %>
            <% when 'paid' %>
              Payé
            <% when 'password_confirmed' %>
              <strong>Comptoir</strong>
            <% when 'demo' %>
              Démo
            <% end %>
            <br>
            <%= order.decorate.price %>
          </td>
          <td class="text-center">
            <%= order.decorate.sent_at %>
          </td>
          <td class="text-center">
            <% if order.handled_at.nil? %>
              <strong>max <%= order.decorate.ready_at_limit %></strong>
              <br>
              <%= render 'orders/button_handled', order: order %>
            <% elsif order.ready_at.nil? %>
              max <%= order.decorate.ready_at_limit %>
              <br>
              <%= render 'orders/button_ready', order: order %>
            <% else %>
              <%= order.decorate.ready_at %>
              <br>
              max <%= order.decorate.ready_at_limit %>
            <% end %>
          </td>
          <td class="text-center">
            <% if order.ready_at && order.delivered_at.nil? %>
              <%= render 'orders/button_delivered', order: order %>
            <% else %>
              <%= order.decorate.delivered_at %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
